<div class="stat-region stat-region--saves">
  <h2>{{localize 'SHEET.saves'}}</h2>
  <ul class="saves-list">
    {{#each saves as |save key|}}
      <li
        class="saves-list__item rollable rollable--no-icon"
        data-label="{{localize (concat 'SHEET.save.' key)}}"
        data-roll-type="Save"
        data-target="{{save}}"
        data-roll="1d20{{signedString (lookup ../saveMods key)}}">
        <h4 class="saves-list__name">
          {{{localize (concat 'SHEET.save.' key)}}}
        </h4>
        <div class="saves-list__score">
          {{localize 'SHEET.listheadings.saves.target'}}: {{save}}
        </div>
        <div class="saves-list__modifier">
          ({{signedString (lookup ../saveMods key)}})
        </div>
      </li>
    {{/each}}
    <li class="saves-list__item">
      <div
        class="saves-list__name rollable rollable--no-icon"
        data-label="Morale"
        data-roll-type="Save"
        data-target="{{data.morale}}"
        data-roll="1d20">
        <h4 class="saves-list__name">Morale</h4>
      </div>
      <div class="saves-list__score">
        {{localize 'SHEET.listheadings.saves.target'}}: {{data.morale}}
      </div>
    </li>
  </ul>
  {{#if (ne (derivedStat 'wis' data.attributes.wis 'modMentalSave') 0)}}
    <p>Reminder: you have a {{signedString (derivedStat 'wis' data.attributes.wis 'modMentalSave')}} to mental saves.</p>
  {{/if}}
</div>

<div class="stat-region stat-region--defenses">
  <h2>Defenses</h2>

  <div class="configuration__field configuration__field--specialDefenses">
    <label for="data.specialDefenses">Special Defenses</label>
    <input
      name="data.specialDefenses"
      value="{{data.specialDefenses}}"
      type="text"
      data-dtype="String" />
  </div>

  <div class="configuration__field configuration__field--magic-resistance">
    <label for="data.magicResistance">Magic Resistance</label>
    <input
      name="data.magicResistance"
      value="{{data.magicResistance}}"
      type="text"
      data-dtype="String" />
  </div>
</div>

<div class="stat-region stat-region--move">
  <h2 class="action-header">
    <span>Movement Options</span>
    <button type="button"  data-action="add-npc-move">
      <i class="fa fa-plus">
        <span class="sr-only">Add a new move option</span>
      </i>
    </button>
  </h2>
  <ul class="move-options">
    {{#each data.move as |move key|}}
      <li class="move-option">
        <select name="data.move.{{key}}.type" data-dtype="String">
          {{#select move.type}}
            {{#each ../moveTypes as |type key|}}
              <option value="{{key}}">{{type}}</option>
            {{/each}}
          {{/select}}
        </select>

        <input
          name="data.move.{{key}}.distance"
          value="{{move.distance}}"
          type="number"
          data-dtype="Number" />

        <button
          type="button"
          data-action="delete-npc-move"
          data-index={{key}}>
          <i class="fa fa-trash">
            <span class="sr-only">Delete this move option</span>
          </i>
        </button>
      </li>
    {{/each}}
  </ul>
</div>

<div class="stat-region stat-region--hp">
  <h2>HP</h2>

  <div class="configuration__field configuration__field--hit-dice">
    <label for="data.hitDice">Hit Dice</label>
    <input
      name="data.hitDice"
      value="{{data.hitDice}}"
      type="text"
      data-dtype="String" />
  </div>

  <div class="configuration__field configuration__field--hit-dice-bonus">
    <label for="data.hitDiceBonus">HP Bonus</label>
    <input
      name="data.hitDiceBonus"
      value="{{data.hitDiceBonus}}"
      type="text"
      data-dtype="String" />
  </div>
</div>

<div class="stat-region stat-region--xp">
  <div>
    <h2>
      <span>XP</span>
      {{#if data.canAutocalculateXP}}
        <span>{{data.calculatedXP}}</span>
      {{/if}}
    </h2>
  </div>
  
  <div class="configuration__field configuration__field--can-autocalculate-xp">
    <label for="data.canAutocalculateXP">Auto-Calculate</label>
    <input
      name="data.canAutocalculateXP"
      type="checkbox"
      {{checked data.canAutocalculateXP}} />
  </div>

  {{#unless data.canAutocalculateXP}}
    <div class="configuration__field configuration__field--xp">
      <label for="data.xp">XP</label>
      <input
        name="data.xp"
        value="{{data.xp}}"
        type="text"
        data-dtype="String" />
    </div>
  {{else}}
    <div class="configuration__field configuration__field--has-special-ability">
      <label for="data.hasSpecialAbility">Has Special Ability?</label>
      <input
        name="data.hasSpecialAbility"
        type="checkbox"
        {{checked data.hasSpecialAbility}} />
    </div>

    <div class="configuration__field configuration__field--is-exceptional">
      <label for="data.isExceptional">Is Exceptional?</label>
      <input
        name="data.isExceptional"
        type="checkbox"
        {{checked data.isExceptional}} />
    </div>
  {{/unless}}
</div>

<div class="stat-region stat-region--configuration">
  <h2>Configuration</h2>
  <div class="configuration__field configuration__field--size">
    <label for="data.size">Size</label>
    <select name="data.size" data-dtype="String">
      {{#select data.size}}
        {{#each sizes as |size key|}}
          <option value="{{key}}">{{size}}</option>
        {{/each}}
      {{/select}}
    </select>
  </div>

  <div class="configuration__field configuration__field--alignment">
    <label for="data.alignment">Alignment</label>
    <select name="data.alignment" data-dtype="String">
      <option value="">Unaligned</option>
      {{#select data.alignment}}
        {{#each alignments as |alignment key|}}
          <option value="{{key}}">{{alignment}}</option>
        {{/each}}
      {{/select}}
    </select>
  </div>

  <div class="configuration__field configuration__field--perception-mod">
    <label for="data.perceptionMod">Perception Mod</label>
    <input
      name="data.perceptionMod"
      value="{{data.perceptionMod}}"
      type="number"
      data-dtype="Number" />
  </div>
</div>

<div class="stat-region stat-region--quantities">
  <h2>Quantities</h2>
  <div class="configuration__field configuration__field--number-appearing">
    <label for="data.numberAppearing">Number Appearing</label>
    <input
      name="data.numberAppearing"
      value="{{data.numberAppearing}}"
      type="text"
      data-dtype="String" />
  </div>

  <div class="configuration__field configuration__field--number-in-lair">
    <label for="data.numberAppearing">Number In Lair</label>
    <input
      name="data.numberInLair"
      value="{{data.numberInLair}}"
      type="text"
      data-dtype="String" />
  </div>
</div>